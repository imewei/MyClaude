workflow:
  name: "performance-optimization"
  description: "Complete performance optimization workflow with profiling and benchmarking"
  version: "1.0"
  author: "Claude Code Framework"
  tags: [performance, optimization, benchmarking]

variables:
  target_path: "."
  language: "auto"
  optimization_category: "all"

steps:
  - id: profile_baseline
    command: run-all-tests
    description: "Profile current performance baseline"
    flags:
      - --profile
      - --benchmark
      - --report
    input: ${target_path}

  - id: identify_bottlenecks
    command: debug
    description: "Identify performance bottlenecks"
    flags:
      - --issue=performance
      - --profile
      - --report
    input: ${target_path}
    depends_on: [profile_baseline]

  - id: optimize_code
    command: optimize
    description: "Apply performance optimizations"
    flags:
      - --language=${language}
      - --category=${optimization_category}
      - --implement
      - --orchestrate
    input: ${target_path}
    depends_on: [identify_bottlenecks]
    retry:
      max_attempts: 3
      backoff: exponential

  - id: parallel_optimizations
    parallel: true
    depends_on: [optimize_code]
    steps:
      - id: optimize_algorithms
        command: optimize
        flags:
          - --category=algorithm
          - --implement
        input: ${target_path}

      - id: optimize_memory
        command: optimize
        flags:
          - --category=memory
          - --implement
        input: ${target_path}

      - id: optimize_io
        command: optimize
        flags:
          - --category=io
          - --implement
        input: ${target_path}

  - id: validate_optimizations
    command: run-all-tests
    description: "Validate optimizations don't break functionality"
    flags:
      - --scope=all
      - --auto-fix
    depends_on: [parallel_optimizations]

  - id: benchmark_improvements
    command: run-all-tests
    description: "Benchmark performance improvements"
    flags:
      - --profile
      - --benchmark
      - --report
    input: ${target_path}
    depends_on: [validate_optimizations]

  - id: update_documentation
    command: update-docs
    description: "Update performance documentation"
    flags:
      - --type=readme
      - --optimize
    depends_on: [benchmark_improvements]

  - id: commit_optimizations
    command: commit
    description: "Commit performance optimizations"
    flags:
      - --all
      - --ai-message
      - --validate
    depends_on: [update_documentation]